<!DOCTYPE html>
<html>
    <head>
        <title>个人中心</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- zui -->
        <link href="css/zui.min.css" rel="stylesheet">
        <link href="lib/datetimepicker/datetimepicker.min.css" rel="stylesheet" type="text/css"/>
    </head>
    <body>
        <!--row-->
        <div class="row">

            <!--Top-->
            <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12">
                <div id="top"></div>
            </div>
            <!--end Top-->

            <!--Left-->
            <div class="col-lg-2 col-md-2 col-xs-2 col-sm-2">
                <div id="left"></div>
            </div>
            <!--end Left-->

            <!--main-->
            <div id="main" class="col-lg-10 col-md-10 col-xs-10 col-sm-10">
                <!--轮播小广告-->
                <!--缺广告-->
                <!--缺广告-->
                <!--缺广告-->
                <!--end轮播小广告-->

                <!--个人信息-->
                <div>
                    <form class="form-horizontal" id="frmInfo" enctype="multipart/form-data" role="form" method='post'>
                        <legend>个人信息</legend>

                        <div class="form-group">
                            <label class="col-md-2 control-label">真实姓名</label>
                            <div class="col-md-2">
                                <input type='text' name='realname' id='realname' class='form-control' placeholder="姓名..." />
                            </div>
                            <label class="col-md-2 control-label">身份证号</label>
                            <div class='col-md-2'>
                                <input type='text' name='idcard' id='idcard' class='form-control' placeholder='18位身份证号' />
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-2 control-label">出生日期</label>
                            <div class="col-md-2">
                                <div class="input-group date form-date" data-date="" data-date-format="dd MM yyyy" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                                    <input class="form-control" size="16" type="text" value="" readonly="" name="birthdate" id="birthdate">
                                    <span class="input-group-addon"><span class="icon-calendar"></span></span>
                                </div>
                            </div>
                            <label class="col-md-2 control-label">性别</label>
                            <div class="col-md-6">
                                <label class="radio-inline"> <input type="radio" name="gender" value="0"> 男 </label>
                                <label class="radio-inline"> <input type="radio" name="gender" value="1"> 女 </label>
                                <label class="radio-inline"> <input type="radio" name="gender" value="2" checked=""> 保密 </label>
                            </div>
                        </div>

                        <!--上传头像-->
                        <div class="form-group">
                            <label class="col-md-2 control-label">头像</label>
                            <input id="icon" type="file" name="icon">
                        </div>

                        <div class="form-group">
                            <label class="col-md-2 control-label">地址1</label>
                            <div class="col-md-8">
                                <input type='text' name='address1' id='address1' class='form-control' placeholder="地址1..." />
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-2 control-label">地址2</label>
                            <div class="col-md-8">
                                <input type='text' name='address2' id='address2' class='form-control' placeholder="地址2...（可选）" />
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-2 control-label">地址3</label>
                            <div class="col-md-8">
                                <input type='text' name='address3' id='address3' class='form-control' placeholder="地址3...（可选）" />
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-2 control-label">地址4</label>
                            <div class="col-md-8">
                                <input type='text' name='address4' id='address4' class='form-control' placeholder="地址4...（可选）" />
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-2 control-label">电话号码</label>
                            <div class="col-md-8">
                                <input type='text' name='phonenumber' id='phonenumber' class='form-control' placeholder="电话号码..." />
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-2 control-label">e-mail</label>
                            <div class="col-md-8">
                                <input type='text' name='email' id='email' class='form-control' placeholder="电子邮箱..." />
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-md-offset-2 col-md-10">
                                <input type='button' id='submit' class='btn btn-primary' value='保存' data-loading='稍候...' />
                                <input type='button' id='cancle' class='btn btn-primary' value='取消' data-loading='稍候...' />
                            </div>
                        </div>

                    </form>
                </div>
                <!--end个人信息-->
            </div>
            <!--end main-->

        </div>
        <!--end row-->

        <!--footer-->
        <footer>
        </footer>
        <!--end footer-->

        <!--js-->
        <!-- jQuery (ZUI中的Javascript组件依赖于jQuery) -->
        <script src="lib/jquery/jquery.js" type="text/javascript"></script>
        <!-- ZUI Javascript组件 -->
        <script src="js/zui.min.js"></script>
        <script src="lib/datetimepicker/datetimepicker.min.js"></script>
        <script src="load/footer.js" type="text/javascript"></script>
        <script src="load/checkLogin.js" type="text/javascript"></script>
        <script src="load/urlconfig.js" type="text/javascript"></script>
        <script>
            // 仅选择日期
            $(".form-date").datetimepicker(
                    {
                        language: "zh-CN",
                        weekStart: 1,
                        todayBtn: 1,
                        autoclose: 1,
                        todayHighlight: 1,
                        startView: 2,
                        minView: 2,
                        forceParse: 0,
                        format: "yyyy-mm-dd"
                    });

            //获取已有的个人信息
            $(document).ready(function () {
                $.ajax({
                    type: 'GET',
                    crossDomain: true,
                    url: serverUrl() + '/index.php?m=User&f=getUserInfo',
                    dataType: 'json',
                    success: function (result) {
                        if (result.result == 0) {
                            var userInfo = result.userinfo;
                            $("#realname").val(userInfo.realname);
                            $("#idcard").val(userInfo.idcard);
                            $("#birthdate").val(userInfo.birthdate);
                            $("[name='gender']").eq(2).removeAttr("checked");
                            $("[name='gender']")[userInfo.gender].checked = true;
                            $("#address1").val(userInfo.address1);
                            $("#address2").val(userInfo.address2);
                            $("#address3").val(userInfo.address3);
                            $("#address4").val(userInfo.address4);
                            $("#phonenumber").val(userInfo.phonenumber);
                            $("#email").val(userInfo.email);
                        } else if (result.result == 1) {
                            var msg = new $.zui.Messager(
                                    '<i class="icon-exclamation-sign"></i>获取信息失败', {
                                        placement: 'center',
                                        type: 'danger'
                                    });
                            msg.show();
                        } else if (result.result == 2) {
                            var msg = new $.zui.Messager(
                                    '<i class="icon-warning-sign"></i>用户未登录！', {
                                        placement: 'center',
                                        type: 'warning'
                                    });
                            msg.show();
                        }
                    },
                    error: function () {
                        var msg = new $.zui.Messager(
                                '<i class="icon-exclamation-sign"></i>网络有问题！', {
                                    placement: 'center',
                                    type: 'danger'
                                });
                        msg.show();
                    },
                });
            });

            //上传编辑的信息
            $("#submit").click(function () {
                //var params = $("#frmInfo").serialize();
                $.ajax({
                    type: 'POST',
                    crossDomain: true,
                    url: 'http://www.shopping.com/index.php?m=User&f=editUserInfo',
                    //data: params,
                    data: new FormData($("#frmInfo")[0]),
                    dataType: 'json',
                    processData: false,
                    contentType: false,
                    success: function (result) {
                        if (result.result == 0) {
                            var msg = new $.zui.Messager(
                                    '<i class="icon-ok-sign"></i>保存成功', {
                                        placement: 'center',
                                        type: 'success'
                                    });
                            msg.show();
                            window.location.reload();
                        } else if (result.result == 1) {
                            var msg = new $.zui.Messager(
                                    '<i class="icon-exclamation-sign"></i>保存失败', {
                                        placement: 'center',
                                        type: 'danger'
                                    });
                            msg.show();
                        } else if (result.result == 2) {
                            var msg = new $.zui.Messager(
                                    '<i class="icon-warning-sign"></i>用户未登录！', {
                                        placement: 'center',
                                        type: 'warning'
                                    });
                            msg.show();
                        }
                    },
                    error: function () {
                        var msg = new $.zui.Messager(
                                '<i class="icon-exclamation-sign"></i>网络有问题！', {
                                    placement: 'center',
                                    type: 'danger'
                                });
                        msg.show();
                    },
                });
            });

            //取消：
            $("#cancle").click(function () {
                window.location.href = 'index.html';
            });
        </script>
    </body>
</html>
